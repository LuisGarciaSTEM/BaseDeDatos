DROP SCHEMA IF EXISTS EJERCICIO_15;
CREATE SCHEMA EJERCICIO_15;
USE EJERCICIO_15;

# APARATO (NOMBRE, ELECTICO?, FUNGIBLE?)
CREATE TABLE APARATO (
	NOMBRE VARCHAR (50) PRIMARY KEY,
    ES_ELECTRICO BOOLEAN,
    ES_FUNGLIBLE BOOLEAN
);

# PRUEBA (ID, NOMBRE_APARATO)
CREATE TABLE PRUEBA (
	ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE_APARATO VARCHAR (50),
    
    FOREIGN KEY (NOMBRE_APARATO) REFERENCES APARATO (NOMBRE)
);

# ESPECIALISTA (N_COLEGIADO, NOMBRE, ESPECIALIDAD)
CREATE TABLE ESPECIALISTA (
	N_COLEGIADO CHAR (12) PRIMARY KEY,
    NOMBRE VARCHAR (50),
    ESPECIALIDAD VARCHAR (50)
);


# PACIENTE (DNI, NSS, NOMBRE, FECHA_NACIMIENTO)
CREATE TABLE PACIENTE (
	DNI CHAR (9),
	NSS	VARCHAR (50) PRIMARY KEY,
    NOMBRE VARCHAR (50),
    FECHA_NACIMIENTO DATE	
);

# HABITACION (PLANTA, NUMERO)
CREATE TABLE HABITACION (
	PLANTA TINYINT,
	NUMERO SMALLINT, 
    
    PRIMARY KEY (PLANTA, NUMERO)
);


# CAMA (NUMERO, TIPO, PLANTA_NUMERO)
CREATE TABLE CAMA (
	TIPO VARCHAR (50),
	NUMERO SMALLINT PRIMARY KEY, 
    PLANTA_CAMA TINYINT,
	NUMERO_CAMA SMALLINT, 
    
	FOREIGN KEY (PLANTA_CAMA) REFERENCES HABITACION (PLANTA),
    FOREIGN KEY (NUMERO_CAMA) REFERENCES HABITACION (NUMERO)
);


# ESPECIALISTA_PACIENTE_REALIZA_PRUEBA (ID, ID_PRUEBA, NSS, HCOLEGIADO, FECHA)
CREATE TABLE ESPECIALISTA_PACIENTE_REALIZA_PRUEBA (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_PRUEBA INT,
    NSS VARCHAR(50),
    HCOLEGIADO CHAR(12),
    FECHA DATETIME,
    
    UNIQUE (ID, ID_PRUEBA, NSS, HCOLEGIADO),
    
    FOREIGN KEY (ID_PRUEBA) REFERENCES PRUEBA(ID),
    FOREIGN KEY (NSS) REFERENCES PACIENTE(NSS),
    FOREIGN KEY (HCOLEGIADO) REFERENCES ESPECIALISTA(HCOLEGIADO)
);

# PACIENTE_INGRESA_HABITACION_CAMA (NSS, PLANTA_NUMERO, NUMERO_CAMA, FECHA_INGRESO, FECHA_ALTA)