DROP SCHEMA IF EXISTS EJERCICIO_8;
CREATE SCHEMA EJERCICIO_8;
USE EJERCICIO_8;

# CLIENTE (ID_CLIENTE, NOMBRE, DIRECCION, TELEFONO, EMAIL)
CREATE TABLE CLIENTE(
	ID_CLIENTE INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50) NOT NULL, 
    DIRECCION VARCHAR (80), 
    TELEFONO VARCHAR (15) UNIQUE,
    EMAIL VARCHAR (100) UNIQUE
);

# ANUNCIO (CODIGO_ANUNCIO, NOMBRE, TIPO, TITULO, CONTENIDO, CATEGORIA, PRECIO, ID_CLIENTE)
CREATE TABLE ANUNCIO(
	CODIGO_ANUNCIO INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50) NOT NULL,
    TIPO VARCHAR (50),
    TITULO VARCHAR (50),
    CONTENIDO MEDIUMTEXT, #DEFAULT ("CONTENIDO MARCA ACME")
    CATEGORIA VARCHAR (50),
    PRECIO DECIMAL (9,2),
    ID_CLIENTE INT,
    
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    
    CONSTRAINT PRECIO_MAYOR_0 CHECK (PRECIO > 0)
);

# WEB (ULR, NOMBRE, TOPICO)
CREATE TABLE WEB (
	URL VARCHAR (255) PRIMARY KEY,
    NOMBRE VARCHAR (50) NOT NULL,
    TOPICO VARCHAR (50)
);

# ANUNCIO_APARECE_WEB (CODIGO_ANUNCIO, URL_WEB, F_INICIO, F_FIN)
CREATE TABLE ANUNCIO_APARECE_WEB(
	CODIGO_ANUNCIO INT,
    URL_WEB VARCHAR (255),
    F_INICIO DATETIME,
    F_FIN DATETIME,  
    
    PRIMARY KEY (CODIGO_ANUNCIO, URL_WEB, F_INICIO),
    
    FOREIGN KEY (CODIGO_ANUNCIO) REFERENCES ANUNCIO (CODIGO_ANUNCIO),
	FOREIGN KEY (URL_WEB) REFERENCES WEB (URL),
    
    CONSTRAINT FECHA_INICIO_MAYOR CHECK (F_FIN > F_INICIO)
);