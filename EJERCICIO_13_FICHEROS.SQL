DROP SCHEMA IF EXISTS EJERCICIO_13;
CREATE SCHEMA EJERCICIO_13;
USE EJERCICIO_13;

# PARTICIPANTE (DNI, NOMBRE)
CREATE TABLE PARTICIPANTE (
	DNI CHAR (9) PRIMARY KEY,
    NOMBRE VARCHAR (50)
);

# ORGANIZADOR (DNI, NOMBRE, EDAD, CARGO, FECHA_INICIO)
CREATE TABLE ORGANIZADOR(
	DNI CHAR (9) PRIMARY KEY,
    NOMBRE VARCHAR (50),
    EDAD TINYINT,
    CARGO VARCHAR (50),
    FECHA_INICIO DATETIME
    
);

# ORGANIZADOR_DIRECTOR (DNI_ORGANIZADOR, CURRICULUM)
CREATE TABLE ORGANIZADOR_DIRECTOR(
	DNI_DIRECTOR CHAR (9) PRIMARY KEY,
    CURRICULUM MEDIUMBLOB,
    
    FOREIGN KEY (DNI_DIRECTOR) REFERENCES ORGANIZADOR (DNI)

);


# CARRERA (ID, FECHA, LUGAR_INICIO, LUGAR_FINAL, DNI_ORGANIZADOR)
CREATE TABLE CARRERA (
	ID INT PRIMARY KEY AUTO_INCREMENT,
    FECHA DATE,
    LUGAR_INICIO VARCHAR (50),
	LUGAR_FINAL VARCHAR (50),
    DNI_ORGANIZADOR CHAR (9),
    
    FOREIGN KEY (DNI_ORGANIZADOR) REFERENCES ORGANIZADOR_DIRECTOR (DNI_DIRECTOR)
);

# ETAPA (ID, KM, ETAPA, ID_CARRERA)
CREATE TABLE ETAPA (
	ID INT PRIMARY KEY AUTO_INCREMENT,
    KILOMETROS FLOAT, 
    ETAPA VARCHAR (50)

);

# CARRERA_A_PIE (ID_CARRERA, DESNIVEL)
CREATE TABLE CARRERA_A_PIE (
	ID_CARRERA INT PRIMARY KEY,
    DESNIVEL FLOAT

);


# CARRERA_CICILISTA (ID_CARRERA, TEMPERATURA, LLUVIA?)
CREATE TABLE CARRERA_CICILISTA (
	ID_CARRERA INT PRIMARY KEY,
    TEMPERATURA FLOAT,
    LLUVIA BOOLEAN
);

# BICICLETA (ID, PESO, MODELO, ELECTRICA_?)
CREATE TABLE BICICLETA (
	ID INT PRIMARY KEY,
    MODELO VARCHAR (50),
    ELECTRICA BOOLEAN,
    PESO FLOAT
);

# PARTICIPANTE_PARTICIPA_CARRERA (DNI_PARTICIPANTE, ID_CARRERA, NUMERO_DORSAL)
CREATE TABLE PARTICIPANTE_PARTICIPA_CARRERA (
	DNI_PARTICIPANTE CHAR (9),
	ID_CARRERA INT,
    NUMERO_DORSAL SMALLINT,
    
    PRIMARY KEY (DNI_PARTICIPANTE, ID_CARRERA),
    
	FOREIGN KEY (DNI_PARTICIPANTE) REFERENCES PARTICIPANTE (DNI),
    FOREIGN KEY (ID_CARRERA) REFERENCES CARRERA (ID)

);

# ORGANIZADOR_ASISTE_CARRERA (ID_CARRERA, DNI_ORGANIZADOR)
CREATE TABLE ORGANIZADOR_ASISTE_CARRERA (
	DNI_ORGANIZADOR CHAR (9),
	ID_CARRERA INT,
    
    PRIMARY KEY (DNI_ORGANIZADOR, ID_CARRERA),
    
	FOREIGN KEY (DNI_ORGANIZADOR) REFERENCES ORGANIZADOR (DNI),
    FOREIGN KEY (ID_CARRERA) REFERENCES CARRERA (ID)
);

# CARRERA_CICLISTA_PERMITE_BICICLETAS (ID_CARRERA, ID_BICILETA)
CREATE TABLE CARRERA_CICLISTA_PERMITE_BICICLETAS (
	ID_BICILETA INT,
	ID_CARRERA_CICLISTA INT,
    
    PRIMARY KEY (ID_CARRERA_CICLISTA, ID_BICILETA),
    
	FOREIGN KEY (ID_CARRERA_CICLISTA) REFERENCES CARRERA_CICILISTA (ID_CARRERA),
    FOREIGN KEY (ID_BICILETA) REFERENCES BICICLETA (ID)
);

