DROP SCHEMA IF EXISTS EJERCICIO_20;
CREATE SCHEMA EJERCICIO_20;
USE EJERCICIO_20;

# MARCA (ID, NOMBRE)
CREATE TABLE MARCA(
	ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50)
);

# MODELO (ID, NOMBRE, ID_MARCA)
CREATE TABLE MODELO (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR(50),
    ID_MARCA INT,
    FOREIGN KEY (ID_MARCA)
        REFERENCES MARCA (ID)
);


# VERSION (ID, NOMBRE, POTENCIA, PRECIO, COMBUSTIBLE, ID_MODELO)
CREATE TABLE VERSION (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR(50),
    POTENCIA SMALLINT,
    PRECIO DECIMAL (9,2),
    COMBUSTIBLE VARCHAR (30),
    ID_MODELO INT,
    
    FOREIGN KEY (ID_MODELO) REFERENCES MODELO (ID)
);

# EXTRA (ID, NOMBRE, DESCRIPCION)
CREATE TABLE EXTRA(
	ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50),
    DESCRIPCION MEDIUMTEXT
); 

# CLIENTE (NIF, NOMBRE, DIRECCION, TELEFONO)
CREATE TABLE CLIENTE(
	NIF CHAR (9) PRIMARY KEY,
    NOMBRE VARCHAR (50),
    DIRECCION VARCHAR (100),
    TELEFONO VARCHAR (15)
    
); 

# VENDEDOR (NIF, NOMBRE, DIRECCION, TELEFONO)
CREATE TABLE VENDEDOR(
	NIF CHAR (9) PRIMARY KEY,
    NOMBRE VARCHAR (50),
    DIRECCION VARCHAR (100),
    TELEFONO VARCHAR (15)
    
); 

# VERSION_EQUIPA_EXTRA (ID_VERSION, ID_EXTRA, PRECIO)
CREATE TABLE VERSION_EQUIPA_EXTRA(
	ID_VERSION INT,
    ID_EXTRA INT,
    PRECIO DECIMAL (9,2),
    
    PRIMARY KEY (ID_VERSION, ID_EXTRA),
    
    FOREIGN KEY (ID_VERSION) REFERENCES VERSION (ID),
    FOREIGN KEY (ID_EXTRA) REFERENCES EXTRA (ID)
    
);


# CLIENTE_COMPRA_MODELO (ID_MODELO, ID_CLIENTE, FECHA, MATRICULA, NIF_VENDEDOR)
# CLIENTE_COMPRA_MODELO (ID_MODELO, ID_CLIENTE, FECHA, MATRICULA, NIF_VENDEDOR)
CREATE TABLE CLIENTE_COMPRA_MODELO (
    ID_MODELO INT,
    NIF_CLIENTE CHAR(9),
    FECHA_COMPRA DATE,
    MATRICULA VARCHAR(10),
    NIF_VENDEDOR CHAR(9),
    
    PRIMARY KEY (ID_MODELO, NIF_CLIENTE, MATRICULA),
    
    FOREIGN KEY (ID_MODELO) REFERENCES MODELO(ID),
    FOREIGN KEY (NIF_CLIENTE) REFERENCES CLIENTE(NIF),
    FOREIGN KEY (NIF_VENDEDOR) REFERENCES VENDEDOR(NIF)
);
