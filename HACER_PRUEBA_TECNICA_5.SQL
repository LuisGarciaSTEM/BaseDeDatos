DROP SCHEMA IF EXISTS PRUEBA_TECNICA_5;
CREATE SCHEMA PRUEBA_TECNICA_5;
USE PRUEBA_TECNICA_5;

# NOMBRE : LUIS GARCIA DIAZ

# EQUIPO (NOMBRE, MOTOR, PATROCINADOR_PRINCIPAL, ID_INTEGRANTE)
CREATE TABLE EQUIPO(
    NOMBRE VARCHAR (50) PRIMARY KEY,
    MOTOR VARCHAR (50),
    PATROCINADOR_PRINCIPAL VARCHAR (50),
    ID_INTEGRANTE INT  
);

# INTEGRANTE (ID, NOMBRE, EDAD, SALARIO, NOMBRE_EQUIPO)
CREATE TABLE INTEGRANTE(
	ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50),
    EDAD TINYINT,
    SALARIO FLOAT,
    NOMBRE_EQUIPO VARCHAR (50),
    
    FOREIGN KEY (NOMBRE_EQUIPO) REFERENCES EQUIPO (NOMBRE)
);

ALTER TABLE EQUIPO 
ADD CONSTRAINT FOREIGN KEY (ID_INTEGRANTE) REFERENCES INTEGRANTE (ID);

# MECANICO (ID_INTEGRANTE, HORAS_FORMACION, FUNCION)
CREATE TABLE MECANICO(
    ID_INTEGRANTE INT PRIMARY KEY,
    HORAS_FORMACION INT, 
    FUNCION VARCHAR (100),  
    
    FOREIGN KEY (ID_INTEGRANTE) REFERENCES INTEGRANTE (ID)
);


# INGENIERO (ID_INTEGRANTE, AÑOS_EXPERIENCIA, ROL)
CREATE TABLE INGENIERO(
    ID_INTEGRANTE INT PRIMARY KEY,
    AÑOS_EXPERIENCIA TINYINT, 
    ROL VARCHAR (100), 
    
    FOREIGN KEY (ID_INTEGRANTE) REFERENCES INTEGRANTE (ID)
);


# PILOTO (ID_INTEGRANTE, TÍTULOS_CAMPEON, CARRERAS_GANADAS, POLES_LOGRADAS)
CREATE TABLE PILOTO(
    ID_INTEGRANTE INT PRIMARY KEY,
    TÍTULOS_CAMPEON SMALLINT, 
    CARRERAS_GANADAS SMALLINT,
    POLES_LOGRADAS SMALLINT,
    
    FOREIGN KEY (ID_INTEGRANTE) REFERENCES INTEGRANTE (ID)
);


# COCHE (ID, PESO, ACELERACION_MAXIMA, ID_INTEGRANTE_PILOTO, ID_INTEGRANTE_INGENIERO)
CREATE TABLE COCHE(
    ID INT PRIMARY KEY AUTO_INCREMENT,
    PESO SMALLINT, 
    ACELERACION_MAXIMA SMALLINT,
    ID_INTEGRANTE_PILOTO INT,
    ID_INTEGRANTE_INGENIERO INT,
    
	FOREIGN KEY (ID_INTEGRANTE_PILOTO) REFERENCES PILOTO (ID_INTEGRANTE),
	FOREIGN KEY (ID_INTEGRANTE_INGENIERO) REFERENCES INGENIERO (ID_INTEGRANTE)
);

# TEMPORADA (ID, AÑO, FECHA_INICIO, FECHA_FIN)
CREATE TABLE TEMPORADA(
    ID INT PRIMARY KEY AUTO_INCREMENT,
    AÑO DATE, 
    FECHA_INICIO DATETIME,
    FECHA_FIN DATETIME
);

# GRAN_PREMIO (ID, NOMBRE, CIRCUITO, FECHA_Y_HORA_CARRERA)
CREATE TABLE GRAN_PREMIO(
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50),
    CIRCUITO VARCHAR (50),
    FECHA_Y_HORA_CARRERA DATETIME
);

# EQUIPO_PARTICIPA_TEMPORADA (NOMBRE_EQUIPO, ID_TEMPORADA)
CREATE TABLE EQUIPO_PARTICIPA_TEMPORADA(
    NOMBRE_EQUIPO VARCHAR (50),
    ID_TEMPORADA INT,
    
    PRIMARY KEY (NOMBRE_EQUIPO, ID_TEMPORADA),
    
	FOREIGN KEY (NOMBRE_EQUIPO) REFERENCES EQUIPO (NOMBRE),
    FOREIGN KEY (ID_TEMPORADA) REFERENCES TEMPORADA (ID)
);

# TEMPORADA_DIVIDE_GRAN_PREMIO (ID_TEMPORADA, ID_GRAN_PREMIO)
CREATE TABLE TEMPORADA_DIVIDE_GRAN_PREMIO(
    ID_TEMPORADA INT,
    ID_GRAN_PREMIO INT,
    
    PRIMARY KEY (ID_TEMPORADA, ID_GRAN_PREMIO),
    
	FOREIGN KEY (ID_TEMPORADA) REFERENCES TEMPORADA (ID),
    FOREIGN KEY (ID_GRAN_PREMIO) REFERENCES GRAN_PREMIO (ID)
);

# GRAN_PREMIO_COMPITE_PILOTO (ID_GRAN_PREMIO, ID_INTEGRANTE_PILOTO)
CREATE TABLE GRAN_PREMIO_COMPITE_PILOTO(
    ID_GRAN_PREMIO INT,
    ID_INTEGRANTE_PILOTO INT,
    
    PRIMARY KEY (ID_GRAN_PREMIO, ID_INTEGRANTE_PILOTO),
	
    FOREIGN KEY (ID_GRAN_PREMIO) REFERENCES GRAN_PREMIO (ID),
    FOREIGN KEY (ID_INTEGRANTE_PILOTO) REFERENCES PILOTO (ID_INTEGRANTE)
);

# MECANICO_MANTIENE_COCHE (ID_INTEGRANTE_MECANICO, ID_COCHE)
CREATE TABLE MECANICO_MANTIENE_COCHE(
    ID_INTEGRANTE_MECANICO INT,
    ID_COCHE INT,
    
    PRIMARY KEY (ID_INTEGRANTE_MECANICO, ID_COCHE),
	
    FOREIGN KEY (ID_INTEGRANTE_MECANICO) REFERENCES MECANICO (ID_INTEGRANTE),
    FOREIGN KEY (ID_COCHE) REFERENCES COCHE (ID)
);

